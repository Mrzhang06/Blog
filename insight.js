function loadInsight(e,a){const t=$(".searchbox"),n=t.find(".searchbox-input"),o=t.find(".searchbox-body");function c(t,e,n){if(!Array.isArray(e)||!e.length||!t)return n?t.slice(0,n):t;const s=t.toLowerCase();e=e.map(e=>{var t=s.indexOf(e.toLowerCase());return e&&-1!==t?[t,t+e.length]:null}).filter(e=>null!==e).sort((e,t)=>e[0]-t[0]||e[1]-t[1]);if(!e.length)return t;let r="",a=0;var o=function(e){let t;const n=[];return e.forEach(e=>{!t||e[0]>t[1]?n.push(t=e):e[1]>t[1]&&(t[1]=e[1])}),n}(e),c=[o[0][0],o[o.length-1][1]];n&&n<c[1]&&(a=c[0]);for(let e=0;e<o.length;e++){var l=o[e];if(r+=t.slice(a,Math.min(l[0],c[0]+n)),n&&l[0]>=c[0]+n)break;r+="<em>"+t.slice(l[0],l[1])+"</em>",a=l[1],e===o.length-1&&(r+=n?t.slice(l[1],Math.min(t.length,c[0]+n+1)):t.slice(l[1]))}return r}function l(e,t,n,s,r){return`<a class="searchbox-result-item" href="${r}">
            <span class="searchbox-result-icon">
                <i class="fa fa-${e}" />
            </span>
            <span class="searchbox-result-content">
                <span class="searchbox-result-title">
                    ${t=null!=t&&""!==t?t:a.untitled}
                    ${n?'<span class="searchbox-result-title-secondary">('+n+")</span>":""}
                </span>
                ${s?'<span class="searchbox-result-preview">'+s+"</span>":""}
            </span>
        </a>`}function i(s,r,e){let t;if(0===e.length)return null;var n=a[r.toLowerCase()];switch(r){case"POSTS":case"PAGES":t=e.map(e=>{return l("file",c(e.title,s),null,c(e.text,s,100),e.link)});break;case"CATEGORIES":case"TAGS":t=e.map(e=>{var t=c(e.name,s),n=c(e.slug,s);return l("CATEGORIES"===r?"folder":"tag",t,n,null,e.link)});break;default:return null}return n=n,$("<section>").addClass("searchbox-result-section").append($("<header>").text(n)).append(t)}function u(e){return e.split(" ").filter(e=>!!e).map(e=>e.toLowerCase())}function h(e,n,s){e=u(e);return e.filter(t=>{return 0<s.filter(e=>!!Object.prototype.hasOwnProperty.call(n,e)&&-1<n[e].toLowerCase().indexOf(t)).length}).length===e.length}function p(e,s,t,r){let a=0;return u(e).forEach(e=>{const n=new RegExp(e,"img");t.forEach((e,t)=>{Object.prototype.hasOwnProperty.call(s,e)&&(e=s[e].match(n),a+=e?e.length*r[t]:0)})}),a}function f(e,t){const n={post:function(e){return p(s,e,["title","text"],[3,1])},page:function(e){return p(s,e,["title","text"],[3,1])},category:function(e){return p(s,e,["name","slug"],[1,1])},tag:function(e){return p(s,e,["name","slug"],[1,1])}};r=s=t;var s,r,t={post:function(e){return h(r,e,["title","text"])},page:function(e){return h(r,e,["title","text"])},category:function(e){return h(r,e,["name","slug"])},tag:function(e){return h(r,e,["name","slug"])}},a=e.posts,o=e.pages,c=e.tags,e=e.categories;return{posts:a.filter(t.post).sort((e,t)=>n.post(t)-n.post(e)).slice(0,5),pages:o.filter(t.page).sort((e,t)=>n.page(t)-n.page(e)).slice(0,5),categories:e.filter(t.category).sort((e,t)=>n.category(t)-n.category(e)).slice(0,5),tags:c.filter(t.tag).sort((e,t)=>n.tag(t)-n.tag(e)).slice(0,5)}}function s(e){var t=$.makeArray(o.find(".searchbox-result-item"));let n=-1;t.forEach((e,t)=>{$(e).hasClass("active")&&(n=t)});var s,r,e=(t.length+n+e)%t.length;$(t[n]).removeClass("active"),$(t[e]).addClass("active"),0!==(t=$(t[e])).length&&(e=o[0].clientHeight,s=t.position().top-o.scrollTop(),(r=t[0].clientHeight+t.position().top)>e+o.scrollTop()&&o.scrollTop(r-o[0].clientHeight),s<0)&&o.scrollTop(t.position().top)}function r(e){e&&e.length&&(location.href=e.attr("href"))}$.getJSON(e.contentUrl,r=>{"#insight-search"===location.hash.trim()&&t.addClass("show"),n.on("input",function(){var e=$(this).val(),t=e,n=f(r,e);o.empty();for(const s in n)o.append(i(u(t),s.toUpperCase(),n[s]))}),n.trigger("input")});let g=!1;$(document).on("click focus",".navbar-main .search",()=>{t.addClass("show"),t.find(".searchbox-input").focus()}).on("click touchend",".searchbox-result-item",function(e){"click"!==e.type&&!g||(r($(this)),g=!1)}).on("click touchend",".searchbox-close",e=>{"click"!==e.type&&!g||($(".navbar-main").css("pointer-events","none"),setTimeout(()=>{$(".navbar-main").css("pointer-events","auto")},400),t.removeClass("show"),g=!1)}).on("keydown",e=>{if(t.hasClass("show"))switch(e.keyCode){case 27:t.removeClass("show");break;case 38:s(-1);break;case 40:s(1);break;case 13:r(o.find(".searchbox-result-item.active").eq(0))}}).on("touchstart",e=>{g=!0}).on("touchmove",e=>{g=!1})}